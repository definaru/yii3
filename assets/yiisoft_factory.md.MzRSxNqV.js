import{_ as s,c as a,o as e,V as i}from"./chunks/framework.szqEfhRr.js";const u=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"yiisoft/factory.md","filePath":"yiisoft/factory.md","lastUpdated":null}'),t={name:"yiisoft/factory.md"},n=i(`<p align="center"><a href="https://github.com/yiisoft" target="_blank"><img src="https://avatars0.githubusercontent.com/u/993323" width="100px"></a><h1 align="center">Yii Factory</h1><br></p><p>This package provides abstract object factory allowing to create objects by given definition with dependencies resolved by a <a href="https://www.php-fig.org/psr/psr-11/" target="_blank" rel="noreferrer">PSR-11</a> container.</p><div class="tags"><p><a href="https://packagist.org/packages/yiisoft/factory" target="_blank" rel="noreferrer"><img src="https://poser.pugx.org/yiisoft/factory/v/stable.png" alt="Latest Stable Version"></a><a href="https://packagist.org/packages/yiisoft/factory" target="_blank" rel="noreferrer"><img src="https://poser.pugx.org/yiisoft/factory/downloads.png" alt="Total Downloads"></a><a href="https://github.com/yiisoft/factory/actions?query=workflow%3Abuild" target="_blank" rel="noreferrer"><img src="https://github.com/yiisoft/factory/workflows/build/badge.svg" alt="Build Status"></a><a href="https://scrutinizer-ci.com/g/yiisoft/factory/?branch=master" target="_blank" rel="noreferrer"><img src="https://scrutinizer-ci.com/g/yiisoft/factory/badges/quality-score.png?b=master" alt="Scrutinizer Code Quality"></a><a href="https://scrutinizer-ci.com/g/yiisoft/factory/?branch=master" target="_blank" rel="noreferrer"><img src="https://scrutinizer-ci.com/g/yiisoft/factory/badges/coverage.png?b=master" alt="Code Coverage"></a><a href="https://dashboard.stryker-mutator.io/reports/github.com/yiisoft/factory/master" target="_blank" rel="noreferrer"><img src="https://img.shields.io/endpoint?style=flat&amp;url=https%3A%2F%2Fbadge-api.stryker-mutator.io%2Fgithub.com%2Fyiisoft%2Ffactory%2Fmaster" alt="Mutation testing badge"></a><a href="https://github.com/yiisoft/factory/actions?query=workflow%3A%22static+analysis%22" target="_blank" rel="noreferrer"><img src="https://github.com/yiisoft/factory/workflows/static%20analysis/badge.svg" alt="static analysis"></a><a href="https://shepherd.dev/github/yiisoft/factory" target="_blank" rel="noreferrer"><img src="https://shepherd.dev/github/yiisoft/factory/coverage.svg" alt="type-coverage"></a></p></div><h2 id="requirements" tabindex="-1">Requirements <a class="header-anchor" href="#requirements" aria-label="Permalink to &quot;Requirements&quot;">​</a></h2><ul><li>PHP 8.0 or higher.</li></ul><h2 id="installation" tabindex="-1">Installation <a class="header-anchor" href="#installation" aria-label="Permalink to &quot;Installation&quot;">​</a></h2><p>The package could be installed with <a href="http://getcomposer.org/download/" target="_blank" rel="noreferrer">composer</a>:</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">composer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> require yiisoft/definitions</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="general-usage" tabindex="-1">General usage <a class="header-anchor" href="#general-usage" aria-label="Permalink to &quot;General usage&quot;">​</a></h2><p>The factory is useful if you need to create objects using <a href="/yiisoft/definitions.html">definition syntax</a> and/or want to configure defaults for objects created.</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$container </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PSR11DependencyInjectionContainer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$factoryConfig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    EngineInterface</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::class</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &#39;class&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> EngineMarkOne</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &#39;__construct()&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &#39;power&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$factory </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Factory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($container, $factoryConfig);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$one </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $factory</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EngineInterface</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$two </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $factory</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;class&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> EngineInterface</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;__construct()&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &#39;power&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 146</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>In the code above we define factory config specifying that when we need <code>EngineInterface</code>, an instance of <code>EngineMarkOne</code> will be created with <code>power</code> constructor argument equals to 42. We also specify that all the dependencies requested by the object created should be resolved by <code>PSR11DependencyInjectionContainer</code>.</p><p>First call to <code>create()</code> uses default configuration of <code>EngineInterface</code> as is. Second call specifies custom configuration for <code>power</code> constructor argument. In this case, configuration specified is merged with default configuration overriding its keys when the key name is the same.</p><h3 id="tuning-for-production" tabindex="-1">Tuning for production <a class="header-anchor" href="#tuning-for-production" aria-label="Permalink to &quot;Tuning for production&quot;">​</a></h3><p>By default, the factory validates definitions right when they are set. In production environment, it makes sense to turn it off by passing <code>false</code> as a third constructor argument:</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$factory </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Factory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($container, $factoryConfig, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="testing" tabindex="-1">Testing <a class="header-anchor" href="#testing" aria-label="Permalink to &quot;Testing&quot;">​</a></h2><h3 id="unit-testing" tabindex="-1">Unit testing <a class="header-anchor" href="#unit-testing" aria-label="Permalink to &quot;Unit testing&quot;">​</a></h3><p>The package is tested with <a href="https://phpunit.de/" target="_blank" rel="noreferrer">PHPUnit</a>. To run tests:</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./vendor/bin/phpunit</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="mutation-testing" tabindex="-1">Mutation testing <a class="header-anchor" href="#mutation-testing" aria-label="Permalink to &quot;Mutation testing&quot;">​</a></h3><p>The package tests are checked with <a href="https://infection.github.io/" target="_blank" rel="noreferrer">Infection</a> mutation framework with <a href="https://github.com/Roave/infection-static-analysis-plugin" target="_blank" rel="noreferrer">Infection Static Analysis Plugin</a>. To run it:</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./vendor/bin/roave-infection-static-analysis-plugin</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="static-analysis" tabindex="-1">Static analysis <a class="header-anchor" href="#static-analysis" aria-label="Permalink to &quot;Static analysis&quot;">​</a></h3><p>The code is statically analyzed with <a href="https://psalm.dev/" target="_blank" rel="noreferrer">Psalm</a>. To run static analysis:</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./vendor/bin/psalm</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="code-style" tabindex="-1">Code style <a class="header-anchor" href="#code-style" aria-label="Permalink to &quot;Code style&quot;">​</a></h3><p>Use <a href="https://github.com/rectorphp/rector" target="_blank" rel="noreferrer">Rector</a> to make codebase follow some specific rules or use either newest or any specific version of PHP:</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./vendor/bin/rector</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="dependencies" tabindex="-1">Dependencies <a class="header-anchor" href="#dependencies" aria-label="Permalink to &quot;Dependencies&quot;">​</a></h3><p>Use <a href="https://github.com/maglnet/ComposerRequireChecker" target="_blank" rel="noreferrer">ComposerRequireChecker</a> to detect transitive <a href="https://getcomposer.org/" target="_blank" rel="noreferrer">Composer</a> dependencies.</p><h2 id="license" tabindex="-1">License <a class="header-anchor" href="#license" aria-label="Permalink to &quot;License&quot;">​</a></h2><p>The Yii Factory is free software. It is released under the terms of the BSD License. Please see <a href="/LICENSE.html"><code>LICENSE</code></a> for more information.</p><p>Maintained by <a href="https://www.yiiframework.com/" target="_blank" rel="noreferrer">Yii Software</a>.</p><h2 id="support-the-project" tabindex="-1">Support the project <a class="header-anchor" href="#support-the-project" aria-label="Permalink to &quot;Support the project&quot;">​</a></h2><p><a href="https://opencollective.com/yiisoft" target="_blank" rel="noreferrer"><img src="https://img.shields.io/badge/Open%20Collective-sponsor-7eadf1?logo=open%20collective&amp;logoColor=7eadf1&amp;labelColor=555555" alt="Open Collective"></a></p><h2 id="follow-updates" tabindex="-1">Follow updates <a class="header-anchor" href="#follow-updates" aria-label="Permalink to &quot;Follow updates&quot;">​</a></h2><div class="tags"><p><a href="https://www.yiiframework.com/" target="_blank" rel="noreferrer"><img src="https://img.shields.io/badge/Powered_by-Yii_Framework-green.svg?style=flat" alt="Official website"></a><a href="https://twitter.com/yiiframework" target="_blank" rel="noreferrer"><img src="https://img.shields.io/badge/twitter-follow-1DA1F2?logo=twitter&amp;logoColor=1DA1F2&amp;labelColor=555555?style=flat" alt="Twitter"></a><a href="https://t.me/yii3en" target="_blank" rel="noreferrer"><img src="https://img.shields.io/badge/telegram-join-1DA1F2?style=flat&amp;logo=telegram" alt="Telegram"></a><a href="https://www.facebook.com/groups/yiitalk" target="_blank" rel="noreferrer"><img src="https://img.shields.io/badge/facebook-join-1DA1F2?style=flat&amp;logo=facebook&amp;logoColor=ffffff" alt="Facebook"></a><a href="https://yiiframework.com/go/slack" target="_blank" rel="noreferrer"><img src="https://img.shields.io/badge/slack-join-1DA1F2?style=flat&amp;logo=slack" alt="Slack"></a></p></div>`,38),r=[n];function l(o,p,h,c,d,k){return e(),a("div",null,r)}const f=s(t,[["render",l]]);export{u as __pageData,f as default};
